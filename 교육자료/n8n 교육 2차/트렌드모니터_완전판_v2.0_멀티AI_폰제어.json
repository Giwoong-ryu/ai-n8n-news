{
  "name": "íŠ¸ë Œë“œëª¨ë‹ˆí„°_ì™„ì „íŒ_v2.0_ë©€í‹°AI_í°ì œì–´",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "start-monitoring",
        "options": {}
      },
      "id": "e356af68-d465-4982-88bf-cc88389791c7",
      "name": "í°ì—ì„œ_ì‹¤í–‰_Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -1296,
        -32
      ],
      "webhookId": "phone-control",
      "notes": "í°ì—ì„œ í˜¸ì¶œí•˜ëŠ” Webhook\n\nURL íŒŒë¼ë¯¸í„°:\n- industry_name: ë¶„ì•¼ëª…\n- keywords: í‚¤ì›Œë“œ (ì‰¼í‘œêµ¬ë¶„)\n- ai_model: claude/gpt4/gemini\n- delivery: kakao/email/both"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a1",
              "name": "industry_name",
              "value": "={{ $json.body.industry_name || $json.query.industry_name || 'AIìŠ¤íƒ€íŠ¸ì—…' }}",
              "type": "string"
            },
            {
              "id": "a2",
              "name": "keywords",
              "value": "={{ $json.body.keywords || $json.query.keywords || 'AI,GPT,Claude,íˆ¬ì' }}",
              "type": "string"
            },
            {
              "id": "a3",
              "name": "ai_model",
              "value": "={{ $json.body.ai_model || $json.query.ai_model || 'claude' }}",
              "type": "string"
            },
            {
              "id": "a4",
              "name": "delivery_method",
              "value": "={{ $json.body.delivery || $json.query.delivery || 'kakao' }}",
              "type": "string"
            },
            {
              "id": "a5",
              "name": "execution_id",
              "value": "={{ $execution.id }}",
              "type": "string"
            },
            {
              "id": "a6",
              "name": "started_at",
              "value": "={{ $now.toISO() }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "483c4669-273a-4d78-9ec7-b709e6ba7a16",
      "name": "ì‚¬ìš©ìì…ë ¥_íŒŒì‹±",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1072,
        -32
      ],
      "notes": "Webhookìœ¼ë¡œ ë°›ì€ íŒŒë¼ë¯¸í„° ì •ë¦¬"
    },
    {
      "parameters": {
        "jsCode": "// ë™ì  í”„ë¦¬ì…‹ ìƒì„± + RSS ìë™ ë§¤ì¹­\n// v1.117.2\n\nconst userInput = $input.first().json;\n\n// RSS í”¼ë“œ ë°ì´í„°ë² ì´ìŠ¤\nconst RSS_DATABASE = {\n  tech: [\n    { url: \"https://techcrunch.com/feed/\", name: \"TechCrunch\" },\n    { url: \"https://platum.kr/feed/\", name: \"Platum\" },\n    { url: \"https://www.venturebeat.com/feed/\", name: \"VentureBeat\" }\n  ],\n  fashion: [\n    { url: \"https://www.fi.co.kr/rss/allArticle.xml\", name: \"íŒ¨ì…˜ì¸ì‚¬ì´íŠ¸\" },\n    { url: \"https://www.apparelnews.co.kr/rss/allArticle.xml\", name: \"ì–´íŒ¨ëŸ´ë‰´ìŠ¤\" },\n    { url: \"https://www.beautynury.com/rss/allArticle.xml\", name: \"ë·°í‹°ëˆ„ë¦¬\" }\n  ],\n  fintech: [\n    { url: \"http://www.fntimes.com/rss/S1N1.xml\", name: \"í•œêµ­ê¸ˆìœµì‹ ë¬¸\" },\n    { url: \"https://www.digitaltoday.co.kr/rss/S1N13.xml\", name: \"ë””ì§€í„¸íˆ¬ë°ì´\" },\n    { url: \"https://www.coindesk.com/arc/outboundfeeds/rss/\", name: \"CoinDesk\" }\n  ],\n  crypto: [\n    { url: \"https://www.coindesk.com/arc/outboundfeeds/rss/\", name: \"CoinDesk\" },\n    { url: \"https://cointelegraph.com/rss\", name: \"Cointelegraph\" },\n    { url: \"http://www.fntimes.com/rss/S1N1.xml\", name: \"í•œêµ­ê¸ˆìœµì‹ ë¬¸\" }\n  ],\n  manufacturing: [\n    { url: \"http://www.kidd.co.kr/rss/allArticle.xml\", name: \"ì‚°ì—…ì¼ë³´\" },\n    { url: \"https://www.etnews.com/rss\", name: \"ì „ìì‹ ë¬¸\" },\n    { url: \"http://www.mfgnews.co.kr/rss/allArticle.xml\", name: \"ë§¤ì¼ê²½ì œì œì¡°\" }\n  ],\n  healthcare: [\n    { url: \"https://www.medigatenews.com/rss/allArticle.xml\", name: \"ë©”ë””ê²Œì´íŠ¸\" },\n    { url: \"https://www.bosa.co.kr/rss/allArticle.xml\", name: \"ë³´ê±´ì‚°ì—…\" },\n    { url: \"http://www.pharmnews.com/rss/allArticle.xml\", name: \"íŒœë‰´ìŠ¤\" }\n  ],\n  general: [\n    { url: \"https://news.google.com/rss\", name: \"Google News\" },\n    { url: \"https://www.chosun.com/arc/outboundfeeds/rss/\", name: \"ì¡°ì„ ì¼ë³´\" },\n    { url: \"https://www.hankyung.com/feed/\", name: \"í•œêµ­ê²½ì œ\" }\n  ]\n};\n\n// í‚¤ì›Œë“œ ê¸°ë°˜ ì¹´í…Œê³ ë¦¬ ìë™ ê°ì§€\nfunction detectCategory(keywords) {\n  const kw = keywords.toLowerCase();\n  \n  if (kw.includes('ai') || kw.includes('ìŠ¤íƒ€íŠ¸ì—…') || kw.includes('í…Œí¬') || kw.includes('gpt')) {\n    return 'tech';\n  }\n  if (kw.includes('íŒ¨ì…˜') || kw.includes('ë·°í‹°') || kw.includes('ëª…í’ˆ') || kw.includes('ìƒ¤ë„¬')) {\n    return 'fashion';\n  }\n  if (kw.includes('ì½”ì¸') || kw.includes('ë¸”ë¡ì²´ì¸') || kw.includes('ì•”í˜¸í™”í') || kw.includes('ë¹„íŠ¸ì½”ì¸')) {\n    return 'crypto';\n  }\n  if (kw.includes('ê¸ˆìœµ') || kw.includes('í•€í…Œí¬') || kw.includes('í˜ì´') || kw.includes('í† ìŠ¤')) {\n    return 'fintech';\n  }\n  if (kw.includes('ì œì¡°') || kw.includes('ê³µì¥') || kw.includes('ë°˜ë„ì²´') || kw.includes('ë°°í„°ë¦¬')) {\n    return 'manufacturing';\n  }\n  if (kw.includes('ì˜ë£Œ') || kw.includes('í—¬ìŠ¤') || kw.includes('ë°”ì´ì˜¤') || kw.includes('ë³‘ì›')) {\n    return 'healthcare';\n  }\n  \n  return 'general';\n}\n\nconst category = detectCategory(userInput.keywords);\nconst keywordsArray = userInput.keywords.split(',').map(k => k.trim()).filter(k => k.length > 0);\n\nconst dynamicPreset = {\n  industry: userInput.industry_name,\n  keywords: keywordsArray,\n  rss_feeds: RSS_DATABASE[category] || RSS_DATABASE.general,\n  news_api_query: keywordsArray.join(' OR '),\n  news_api_language: 'ko',\n  urgent_keywords: keywordsArray.slice(0, 3),\n  detected_category: category,\n  user_input: userInput,\n  created_at: new Date().toISOString()\n};\n\nconsole.log(`ë™ì  í”„ë¦¬ì…‹ ìƒì„±: ${userInput.industry_name}, ì¹´í…Œê³ ë¦¬: ${category}`);\n\nreturn [{ json: dynamicPreset }];"
      },
      "id": "d4ce51aa-c5b7-4cc4-a8cb-00d37851fe21",
      "name": "ë™ì _í”„ë¦¬ì…‹_ìƒì„±",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -864,
        -32
      ],
      "notes": "í‚¤ì›Œë“œ ê¸°ë°˜ RSS ìë™ ë§¤ì¹­"
    },
    {
      "parameters": {
        "url": "={{ $json.rss_feeds[0].url }}",
        "options": {}
      },
      "id": "159cdace-3989-4d7f-a120-5167af7d9cd7",
      "name": "RSSìˆ˜ì§‘_1",
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1,
      "position": [
        -640,
        -240
      ]
    },
    {
      "parameters": {
        "url": "={{ $json.rss_feeds[1].url }}",
        "options": {}
      },
      "id": "1ab150a5-8d43-44fb-a96a-ff853e81ddfe",
      "name": "RSSìˆ˜ì§‘_2",
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1,
      "position": [
        -640,
        -112
      ]
    },
    {
      "parameters": {
        "url": "={{ $json.rss_feeds[2].url }}",
        "options": {}
      },
      "id": "098d9253-d8dd-47c9-b6f9-c031fb479244",
      "name": "RSSìˆ˜ì§‘_3",
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1,
      "position": [
        -640,
        16
      ]
    },
    {
      "parameters": {
        "url": "https://newsapi.org/v2/everything",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "q",
              "value": "={{ $json.news_api_query }}"
            },
            {
              "name": "language",
              "value": "ko"
            },
            {
              "name": "sortBy",
              "value": "publishedAt"
            },
            {
              "name": "pageSize",
              "value": "20"
            },
            {
              "name": "from",
              "value": "={{ $now.minus({days: 1}).toFormat('yyyy-MM-dd') }}"
            }
          ]
        },
        "options": {}
      },
      "id": "6d7912db-ce0a-46ee-984e-54d8d91e4f95",
      "name": "NewsAPI_ìˆ˜ì§‘",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -640,
        144
      ],
      "credentials": {
        "httpHeaderAuth": {
          "id": "ndw6cfMYFLSb7oOe",
          "name": "Header Auth account"
        }
      },
      "notes": "Credentials ì„¤ì •:\nName: X-Api-Key\nValue: (ë°œê¸‰ë°›ì€ NewsAPI Key)"
    },
    {
      "parameters": {
        "jsCode": "const allItems = $input.all();\nreturn allItems;"
      },
      "id": "813f8a54-8b5f-4ef6-aca3-117acc5db3bd",
      "name": "ì†ŒìŠ¤_íƒœê¹…",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -368,
        -32
      ]
    },
    {
      "parameters": {
        "jsCode": "// ì¤‘ë³µ ì œê±° + ë‚ ì§œ í•„í„°ë§\nconst items = $input.all();\nconst seenUrls = new Set();\nconst uniqueItems = [];\n\nconst sevenDaysAgo = new Date();\nsevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);\n\nfor (const item of items) {\n  const url = item.json.link;\n  \n  if (!seenUrls.has(url)) {\n    seenUrls.add(url);\n    \n    const pubDate = new Date(item.json.pubDate);\n    if (pubDate >= sevenDaysAgo && !isNaN(pubDate.getTime())) {\n      uniqueItems.push(item);\n    }\n  }\n}\n\nuniqueItems.sort((a, b) => new Date(b.json.pubDate) - new Date(a.json.pubDate));\n\nconsole.log(`ì¤‘ë³µ ì œê±°: ${items.length}ê±´ â†’ ${uniqueItems.length}ê±´`);\nreturn uniqueItems;"
      },
      "id": "68c11c1c-5b79-40ca-8e7a-148df7536883",
      "name": "ì¤‘ë³µ_ì œê±°",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -160,
        -32
      ]
    },
    {
      "parameters": {
        "jsCode": "// í‚¤ì›Œë“œ í•„í„°ë§\nconst items = $input.all();\nconst preset = $('ë™ì _í”„ë¦¬ì…‹_ìƒì„±').item.json;\nconst keywords = preset.keywords || [];\nconst urgentKeywords = preset.urgent_keywords || [];\n\nconst filtered = [];\n\nfor (const item of items) {\n  const title = (item.json.title || '').toLowerCase();\n  const content = (item.json.content || '').toLowerCase();\n  const fullText = `${title} ${content}`;\n  \n  const matchedKeywords = keywords.filter(keyword => \n    fullText.includes(keyword.toLowerCase())\n  );\n  \n  const matchedUrgent = urgentKeywords.filter(keyword =>\n    fullText.includes(keyword.toLowerCase())\n  );\n  \n  if (matchedKeywords.length > 0) {\n    filtered.push({\n      json: {\n        ...item.json,\n        matched_keywords: matchedKeywords,\n        is_urgent: matchedUrgent.length > 0,\n        keyword_count: matchedKeywords.length\n      }\n    });\n  }\n}\n\nconsole.log(`í‚¤ì›Œë“œ í•„í„°ë§: ${items.length}ê±´ â†’ ${filtered.length}ê±´`);\nreturn filtered;"
      },
      "id": "814207c2-27d0-48c6-a8fc-f543129dc737",
      "name": "í‚¤ì›Œë“œ_í•„í„°ë§",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        48,
        -32
      ]
    },
    {
      "parameters": {
        "jsCode": "// ê°ì • ë¶„ì„\nconst items = $input.all();\n\nconst positiveWords = ['ì„±ì¥', 'ìƒìŠ¹', 'ì¦ê°€', 'ì„±ê³µ', 'í˜ì‹ ', 'íšê¸°ì ', 'growth', 'success', 'innovation'];\nconst negativeWords = ['í•˜ë½', 'ê°ì†Œ', 'ì‹¤íŒ¨', 'ìœ„ê¸°', 'ë…¼ë€', 'ë¬¸ì œ', 'decline', 'failure', 'crisis'];\n\nconst analyzed = items.map(item => {\n  const text = `${item.json.title || ''} ${item.json.content || ''}`.toLowerCase();\n  \n  let positiveScore = 0;\n  let negativeScore = 0;\n  \n  for (const word of positiveWords) {\n    const regex = new RegExp(word.toLowerCase(), 'g');\n    const matches = text.match(regex);\n    if (matches) positiveScore += matches.length;\n  }\n  \n  for (const word of negativeWords) {\n    const regex = new RegExp(word.toLowerCase(), 'g');\n    const matches = text.match(regex);\n    if (matches) negativeScore += matches.length;\n  }\n  \n  let sentiment = 'ì¤‘ë¦½';\n  if (positiveScore > negativeScore) sentiment = 'ê¸ì •';\n  else if (negativeScore > positiveScore) sentiment = 'ë¶€ì •';\n  \n  return {\n    json: {\n      ...item.json,\n      sentiment: sentiment,\n      positive_count: positiveScore,\n      negative_count: negativeScore\n    }\n  };\n});\n\nreturn analyzed;"
      },
      "id": "55902ba3-168b-4cea-9dc2-b51902676549",
      "name": "ê°ì •_ë¶„ì„",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        256,
        -32
      ]
    },
    {
      "parameters": {
        "jsCode": "// ì¤‘ìš”ë„ íŒë‹¨\nconst items = $input.all();\nconst preset = $('ë™ì _í”„ë¦¬ì…‹_ìƒì„±').item.json;\n\nconst scored = items.map(item => {\n  let score = 0;\n  const reasons = [];\n  \n  if (item.json.is_urgent) {\n    score += 30;\n    reasons.push('ê¸´ê¸‰');\n  }\n  \n  const keywordBonus = Math.min(item.json.keyword_count * 5, 20);\n  score += keywordBonus;\n  \n  if (item.json.positive_count >= 3 || item.json.negative_count >= 3) {\n    score += 15;\n    reasons.push(`ê°•í•œ ${item.json.sentiment}`);\n  }\n  \n  const hoursSince = (Date.now() - new Date(item.json.pubDate)) / (1000 * 60 * 60);\n  if (hoursSince < 24) {\n    score += 5;\n    reasons.push('ìµœì‹ ');\n  }\n  \n  let importance = 'ë‚®ìŒ';\n  if (score >= 50) importance = 'ë†’ìŒ';\n  else if (score >= 30) importance = 'ë³´í†µ';\n  \n  return {\n    json: {\n      ...item.json,\n      importance,\n      importance_score: score\n    }\n  };\n});\n\nscored.sort((a, b) => b.json.importance_score - a.json.importance_score);\nreturn scored;"
      },
      "id": "9328d310-5271-49fd-8875-332d6422a9a0",
      "name": "ì¤‘ìš”ë„_íŒë‹¨",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        480,
        -32
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "s1",
              "name": "timestamp",
              "value": "={{ $now.toISO() }}",
              "type": "string"
            },
            {
              "id": "s2",
              "name": "date",
              "value": "={{ $now.toFormat('yyyy-MM-dd') }}",
              "type": "string"
            },
            {
              "id": "s3",
              "name": "industry",
              "value": "={{ $('ë™ì _í”„ë¦¬ì…‹_ìƒì„±').item.json.industry }}",
              "type": "string"
            },
            {
              "id": "s4",
              "name": "source",
              "value": "={{ $json.source }}",
              "type": "string"
            },
            {
              "id": "s5",
              "name": "title",
              "value": "={{ $json.title.substring(0, 200) }}",
              "type": "string"
            },
            {
              "id": "s6",
              "name": "url",
              "value": "={{ $json.link }}",
              "type": "string"
            },
            {
              "id": "s7",
              "name": "keywords",
              "value": "={{ $json.matched_keywords.join(', ') }}",
              "type": "string"
            },
            {
              "id": "s8",
              "name": "sentiment",
              "value": "={{ $json.sentiment }}",
              "type": "string"
            },
            {
              "id": "s9",
              "name": "importance",
              "value": "={{ $json.importance }}",
              "type": "string"
            },
            {
              "id": "s10",
              "name": "is_urgent",
              "value": "={{ $json.is_urgent ? 'TRUE' : 'FALSE' }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "2e4e407b-fc25-4dd0-b525-bbab02ceee46",
      "name": "Sheetsìš©_êµ¬ì¡°í™”",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        688,
        -32
      ]
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1VSNMCczgG7j6i0KeWj7JSHOOHt81p0BzSZYSOznHFG4/edit?pli=1&gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "ì›ë³¸ë°ì´í„°",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1VSNMCczgG7j6i0KeWj7JSHOOHt81p0BzSZYSOznHFG4/edit#gid=0"
        },
        "columns": {
          "mappingMode": "autoMapInputData",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "fddc628d-a9ad-4dfe-98ca-dab1301a4e69",
      "name": "Google_Sheets_ì €ì¥",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        -1216,
        416
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "4qwkEWnRGPwHS4yn",
          "name": "Google Sheets account"
        }
      },
      "notes": "ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ID ì…ë ¥ í•„ìš”"
    },
    {
      "parameters": {
        "jsCode": "// ìš”ì•½ í†µê³„ ìƒì„±\nconst items = $input.all();\nconst userConfig = $('ì‚¬ìš©ìì…ë ¥_íŒŒì‹±').item.json;\nconst preset = $('ë™ì _í”„ë¦¬ì…‹_ìƒì„±').item.json;\n\nconst stats = {\n  total_count: items.length,\n  urgent_count: items.filter(i => i.json.is_urgent === 'TRUE').length,\n  high_importance: items.filter(i => i.json.importance === 'ë†’ìŒ').length,\n  positive_count: items.filter(i => i.json.sentiment === 'ê¸ì •').length,\n  negative_count: items.filter(i => i.json.sentiment === 'ë¶€ì •').length,\n  neutral_count: items.filter(i => i.json.sentiment === 'ì¤‘ë¦½').length\n};\n\nconst top5 = items\n  .sort((a, b) => (b.json.importance_score || 0) - (a.json.importance_score || 0))\n  .slice(0, 5)\n  .map(item => ({\n    title: item.json.title,\n    url: item.json.url,\n    importance: item.json.importance\n  }));\n\nreturn [{\n  json: {\n    industry: preset.industry,\n    execution_id: userConfig.execution_id,\n    started_at: userConfig.started_at,\n    stats: stats,\n    top_5_news: top5,\n    all_items: items\n  }\n}];"
      },
      "id": "f3cb20f8-6d10-4d3d-9363-55d1420637a0",
      "name": "ìš”ì•½í†µê³„_ìƒì„±",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1024,
        416
      ],
      "notes": "í†µê³„ ê³„ì‚°"
    },
    {
      "parameters": {
        "jsCode": "// AI í”„ë¡¬í”„íŠ¸ ì¤€ë¹„\nconst data = $input.first().json;\nconst userConfig = $('ì‚¬ìš©ìì…ë ¥_íŒŒì‹±').item.json;\n\nconst top10News = data.all_items\n  .slice(0, 10)\n  .map(item => `[${item.json.source}] ${item.json.title}`)\n  .join('\\n');\n\nconst prompt = `ë‹¹ì‹ ì€ ${data.industry} ë¶„ì•¼ì˜ íŠ¸ë Œë“œ ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.\n\n## í†µê³„ ìš”ì•½\n- ì´ ${data.stats.total_count}ê±´ ìˆ˜ì§‘\n- ê¸´ê¸‰: ${data.stats.urgent_count}ê±´\n- ë†’ì€ ì¤‘ìš”ë„: ${data.stats.high_importance}ê±´\n- ê°ì •: ê¸ì • ${data.stats.positive_count}ê±´, ë¶€ì • ${data.stats.negative_count}ê±´, ì¤‘ë¦½ ${data.stats.neutral_count}ê±´\n\n## ì£¼ìš” ë‰´ìŠ¤ TOP 10\n${top10News}\n\n---\n\në‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ë¶„ì„í•´ì£¼ì„¸ìš”:\n\n1. í•µì‹¬ íŠ¸ë Œë“œ (3ì¤„ ìš”ì•½)\n2. ì£¼ìš” ì´ìŠˆ TOP 3 (ê°ê° 1ë¬¸ì¥)\n3. ê¸ì •/ë¶€ì • ì‹ í˜¸ í•´ì„\n4. í–¥í›„ ì£¼ëª©í•  í‚¤ì›Œë“œ 5ê°œ\n5. ì•¡ì…˜ ì•„ì´í…œ (ì¶”ì²œ ëŒ€ì‘ ë°©ì•ˆ 3ê°€ì§€)`;\n\nreturn [{\n  json: {\n    prompt: prompt,\n    ai_model: userConfig.ai_model,\n    stats: data.stats,\n    industry: data.industry,\n    top_news: top10News\n  }\n}];"
      },
      "id": "d8141f5a-f2be-4c84-b4c5-37f3d51e3e66",
      "name": "AI_í”„ë¡¬í”„íŠ¸_ì¤€ë¹„",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -848,
        416
      ],
      "notes": "í”„ë¡¬í”„íŠ¸ ìƒì„±"
    },
    {
      "parameters": {
        "mode": "expression",
        "output": "={{ $json.ai_model }}"
      },
      "id": "ce0d22b3-f582-4297-9f39-074ec8e05dee",
      "name": "AIëª¨ë¸_ë¶„ê¸°",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -656,
        384
      ],
      "notes": "AI ëª¨ë¸ ì„ íƒ"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.anthropic.com/v1/messages",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "anthropic-version",
              "value": "2023-06-01"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ {\n  \"model\": \"claude-sonnet-4-20250514\",\n  \"max_tokens\": 2000,\n  \"messages\": [{\n    \"role\": \"user\",\n    \"content\": $json.prompt\n  }]\n} }}",
        "options": {}
      },
      "id": "cd4d0354-8e8f-4a69-8959-130a29ec5e65",
      "name": "Claude_API",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -432,
        560
      ],
      "credentials": {
        "httpHeaderAuth": {
          "id": "ndw6cfMYFLSb7oOe",
          "name": "Header Auth account"
        }
      },
      "notes": "Credentials:\nHeader: x-api-key\nValue: sk-ant-xxx..."
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.openai.com/v1/chat/completions",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ {\n  \"model\": \"gpt-4o\",\n  \"max_tokens\": 2000,\n  \"messages\": [{\n    \"role\": \"user\",\n    \"content\": $json.prompt\n  }]\n} }}",
        "options": {}
      },
      "id": "0606a413-d49c-4491-96ea-5bb50acfb60d",
      "name": "GPT4_API",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -432,
        400
      ],
      "credentials": {
        "httpHeaderAuth": {
          "id": "ndw6cfMYFLSb7oOe",
          "name": "Header Auth account"
        }
      },
      "notes": "Credentials:\nHeader: Authorization\nValue: Bearer sk-proj-xxx..."
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key={{ $credentials.gemini_key }}",
        "authentication": "genericCredentialType",
        "genericAuthType": "oAuth2",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ {\n  \"contents\": [{\n    \"parts\": [{\n      \"text\": $json.prompt\n    }]\n  }],\n  \"generationConfig\": {\n    \"temperature\": 0.7,\n    \"maxOutputTokens\": 2000\n  }\n} }}",
        "options": {}
      },
      "id": "4cfea13f-7652-4a93-8e9a-0382b6a80ead",
      "name": "Gemini_API",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -432,
        256
      ],
      "notes": "URLì— API Key ì§ì ‘ ì…ë ¥:\nhttps://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key=YOUR_API_KEY"
    },
    {
      "parameters": {
        "jsCode": "// AI ì‘ë‹µ íŒŒì‹±\nconst item = $input.first().json;\nlet aiResponse = '';\nlet modelUsed = '';\n\n// Claude ì‘ë‹µ\nif (item.content && Array.isArray(item.content)) {\n  aiResponse = item.content[0].text;\n  modelUsed = 'Claude Sonnet 4';\n}\n// OpenAI ì‘ë‹µ\nelse if (item.choices && Array.isArray(item.choices)) {\n  aiResponse = item.choices[0].message.content;\n  modelUsed = 'GPT-4o';\n}\n// Gemini ì‘ë‹µ\nelse if (item.candidates && Array.isArray(item.candidates)) {\n  aiResponse = item.candidates[0].content.parts[0].text;\n  modelUsed = 'Gemini 2.0 Flash';\n}\nelse {\n  aiResponse = 'AI ì‘ë‹µ íŒŒì‹± ì‹¤íŒ¨';\n  modelUsed = 'Error';\n}\n\nconst promptData = $('AI_í”„ë¡¬í”„íŠ¸_ì¤€ë¹„').item.json;\n\nreturn [{\n  json: {\n    raw_insights: aiResponse,\n    ai_model_used: modelUsed,\n    stats: promptData.stats,\n    industry: promptData.industry,\n    top_news: promptData.top_news,\n    generated_at: new Date().toISOString()\n  }\n}];"
      },
      "id": "36123f6f-4a5d-4537-8fcf-af900997515a",
      "name": "ì¸ì‚¬ì´íŠ¸_íŒŒì‹±",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -176,
        400
      ],
      "notes": "AI ì‘ë‹µ íŒŒì‹±"
    },
    {
      "parameters": {
        "jsCode": "// ë³´ê³ ì„œ ìƒì„± (Markdown)\nconst insights = $input.first().json;\nconst userConfig = $('ì‚¬ìš©ìì…ë ¥_íŒŒì‹±').item.json;\n\nconst reportMarkdown = `# ${insights.industry} íŠ¸ë Œë“œ ëª¨ë‹ˆí„°ë§ ë³´ê³ ì„œ\n\n**ìƒì„±ì¼ì‹œ**: ${new Date().toLocaleString('ko-KR')}\n**ë¶„ì„ ê¸°ê°„**: ìµœê·¼ 7ì¼\n**AI ëª¨ë¸**: ${insights.ai_model_used}\n**ë¶„ì„ì**: n8n ìë™ ì‹œìŠ¤í…œ\n\n---\n\n## ğŸ“Š ë°ì´í„° ìš”ì•½\n\n- **ì´ ìˆ˜ì§‘ ê±´ìˆ˜**: ${insights.stats.total_count}ê±´\n- **ê¸´ê¸‰ ì•Œë¦¼**: ${insights.stats.urgent_count}ê±´\n- **ë†’ì€ ì¤‘ìš”ë„**: ${insights.stats.high_importance}ê±´\n\n### ê°ì • ë¶„ì„\n- ğŸ˜Š ê¸ì •: ${insights.stats.positive_count}ê±´ (${Math.round(insights.stats.positive_count/insights.stats.total_count*100)}%)\n- ğŸ˜” ë¶€ì •: ${insights.stats.negative_count}ê±´ (${Math.round(insights.stats.negative_count/insights.stats.total_count*100)}%)\n- ğŸ˜ ì¤‘ë¦½: ${insights.stats.neutral_count}ê±´ (${Math.round(insights.stats.neutral_count/insights.stats.total_count*100)}%)\n\n---\n\n## ğŸ¤– AI ì¸ì‚¬ì´íŠ¸ ë¶„ì„\n\n${insights.raw_insights}\n\n---\n\n## ğŸ“° ì£¼ìš” ë‰´ìŠ¤ TOP 10\n\n${insights.top_news}\n\n---\n\n*ë³¸ ë³´ê³ ì„œëŠ” AI ê¸°ë°˜ ìë™ ë¶„ì„ ì‹œìŠ¤í…œìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.*\n`;\n\nreturn [{\n  json: {\n    report_content: reportMarkdown,\n    report_title: `${insights.industry}_íŠ¸ë Œë“œë¦¬í¬íŠ¸_${new Date().toISOString().split('T')[0]}`,\n    insights: insights,\n    user_config: userConfig\n  }\n}];"
      },
      "id": "98b1c6c7-ee76-47bb-93fe-f2ea08c8c61a",
      "name": "ë³´ê³ ì„œ_ìƒì„±",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        0,
        400
      ],
      "notes": "Markdown ë³´ê³ ì„œ"
    },
    {
      "parameters": {
        "mode": "expression",
        "numberOutputs": 3,
        "output": "={{ $json.user_config.delivery_method }}"
      },
      "id": "012e7222-d808-4458-bca3-061441bdb716",
      "name": "ë°œì†¡ë°©ë²•_ì„ íƒ",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        192,
        384
      ],
      "notes": "kakao/email/both"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://kapi.kakao.com/v2/api/talk/memo/default/send",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "contentType": "form-urlencoded",
        "bodyParameters": {
          "parameters": [
            {
              "name": "template_object",
              "value": "={{ JSON.stringify({\n  object_type: 'feed',\n  content: {\n    title: 'ğŸ¤– AI íŠ¸ë Œë“œ ë¶„ì„ ì™„ë£Œ',\n    description: `${$json.insights.industry} ë°ì´í„° ìˆ˜ì§‘ ì™„ë£Œ\\n\\nğŸ“Š ì´ ${$json.insights.stats.total_count}ê±´ (ê¸´ê¸‰ ${$json.insights.stats.urgent_count}ê±´)\\nğŸ˜Š ê¸ì • ${Math.round($json.insights.stats.positive_count/$json.insights.stats.total_count*100)}% | ğŸ˜” ë¶€ì • ${Math.round($json.insights.stats.negative_count/$json.insights.stats.total_count*100)}%\\n\\nğŸ¤– ë¶„ì„: ${$json.insights.ai_model_used}`,\n    image_url: 'https://cdn-icons-png.flaticon.com/512/2920/2920277.png',\n    link: {\n      web_url: 'https://lookerstudio.google.com/ëŒ€ì‹œë³´ë“œë§í¬',\n      mobile_web_url: 'https://lookerstudio.google.com/ëŒ€ì‹œë³´ë“œë§í¬'\n    }\n  },\n  buttons: [\n    {\n      title: 'ğŸ“ˆ ëŒ€ì‹œë³´ë“œ ë³´ê¸°',\n      link: {\n        web_url: 'https://lookerstudio.google.com/ëŒ€ì‹œë³´ë“œë§í¬',\n        mobile_web_url: 'https://lookerstudio.google.com/ëŒ€ì‹œë³´ë“œë§í¬'\n      }\n    }\n  ]\n}) }}"
            }
          ]
        },
        "options": {}
      },
      "id": "9076b8cb-1aad-4b53-b60b-f8a1103a4a8d",
      "name": "ì¹´ì¹´ì˜¤í†¡_ë°œì†¡",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        400,
        320
      ],
      "credentials": {
        "httpHeaderAuth": {
          "id": "ndw6cfMYFLSb7oOe",
          "name": "Header Auth account"
        }
      },
      "notes": "Credentials:\nHeader: Authorization\nValue: Bearer YOUR_ACCESS_TOKEN"
    },
    {
      "parameters": {
        "sendTo": "={{ $json.user_config.email || 'user@example.com' }}",
        "subject": "=ğŸ¤– {{ $json.insights.industry }} íŠ¸ë Œë“œ ë¶„ì„ ë³´ê³ ì„œ",
        "message": "=<!DOCTYPE html>\n<html>\n<head>\n  <style>\n    body { font-family: 'Noto Sans KR', sans-serif; }\n    .header { background: #4285f4; color: white; padding: 20px; }\n    .insight { background: #f8f9fa; padding: 15px; margin: 10px 0; border-left: 4px solid #4285f4; white-space: pre-wrap; }\n    .stats { display: flex; gap: 20px; flex-wrap: wrap; }\n    .stat-card { background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); flex: 1; min-width: 150px; }\n    .stat-value { font-size: 32px; font-weight: bold; color: #4285f4; }\n  </style>\n</head>\n<body>\n  <div class=\"header\">\n    <h1>ğŸ¤– {{ $json.insights.industry }} íŠ¸ë Œë“œ ë¶„ì„ ë³´ê³ ì„œ</h1>\n    <p>{{ $now.toFormat('yyyy-MM-dd HH:mm') }} ìƒì„± | AI ëª¨ë¸: {{ $json.insights.ai_model_used }}</p>\n  </div>\n  \n  <div style=\"padding: 20px;\">\n    <h2>ğŸ“Š ë°ì´í„° ìš”ì•½</h2>\n    <div class=\"stats\">\n      <div class=\"stat-card\">\n        <div>ì´ ê±´ìˆ˜</div>\n        <div class=\"stat-value\">{{ $json.insights.stats.total_count }}</div>\n      </div>\n      <div class=\"stat-card\">\n        <div>ğŸ”´ ê¸´ê¸‰</div>\n        <div class=\"stat-value\">{{ $json.insights.stats.urgent_count }}</div>\n      </div>\n      <div class=\"stat-card\">\n        <div>ğŸ˜Š ê¸ì •</div>\n        <div class=\"stat-value\">{{ $json.insights.stats.positive_count }}</div>\n      </div>\n      <div class=\"stat-card\">\n        <div>ğŸ˜” ë¶€ì •</div>\n        <div class=\"stat-value\">{{ $json.insights.stats.negative_count }}</div>\n      </div>\n    </div>\n    \n    <h2>ğŸ’¡ AI ì¸ì‚¬ì´íŠ¸</h2>\n    <div class=\"insight\">{{ $json.insights.raw_insights }}</div>\n    \n    <a href=\"https://lookerstudio.google.com/ëŒ€ì‹œë³´ë“œë§í¬\" style=\"display: inline-block; background: #4285f4; color: white; padding: 15px 30px; text-decoration: none; border-radius: 5px; margin: 20px 0;\">\n      ğŸ“ˆ ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ ë³´ê¸°\n    </a>\n  </div>\n</body>\n</html>",
        "options": {}
      },
      "id": "f44a0375-6194-4d24-a840-e432d4b3fce6",
      "name": "Gmail_ë°œì†¡",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        400,
        480
      ],
      "webhookId": "75f28985-0030-43b9-82d5-b8910220012a",
      "credentials": {
        "gmailOAuth2": {
          "id": "bFKiXUBlTxMQk24Y",
          "name": "Gmail account"
        }
      },
      "notes": "Gmail OAuth2 ì—°ê²° í•„ìš”"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ {\n  success: true,\n  message: 'íŠ¸ë Œë“œ ëª¨ë‹ˆí„°ë§ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤',\n  industry: $('ë™ì _í”„ë¦¬ì…‹_ìƒì„±').item.json.industry,\n  execution_id: $('ì‚¬ìš©ìì…ë ¥_íŒŒì‹±').item.json.execution_id,\n  ai_model: $('ì‚¬ìš©ìì…ë ¥_íŒŒì‹±').item.json.ai_model,\n  estimated_time: 'ì•½ 2-3ë¶„ ì†Œìš”',\n  notification: 'ì™„ë£Œ ì‹œ ì•Œë¦¼ì´ ì „ì†¡ë©ë‹ˆë‹¤'\n} }}",
        "options": {}
      },
      "id": "a8ae93c5-c47b-426c-a59d-e6b47d551da7",
      "name": "Webhook_ì‘ë‹µ",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        624,
        400
      ],
      "notes": "í°ìœ¼ë¡œ ì¦‰ì‹œ ì‘ë‹µ"
    }
  ],
  "pinData": {},
  "connections": {
    "í°ì—ì„œ_ì‹¤í–‰_Webhook": {
      "main": [
        [
          {
            "node": "ì‚¬ìš©ìì…ë ¥_íŒŒì‹±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ì‚¬ìš©ìì…ë ¥_íŒŒì‹±": {
      "main": [
        [
          {
            "node": "ë™ì _í”„ë¦¬ì…‹_ìƒì„±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ë™ì _í”„ë¦¬ì…‹_ìƒì„±": {
      "main": [
        [
          {
            "node": "RSSìˆ˜ì§‘_1",
            "type": "main",
            "index": 0
          },
          {
            "node": "RSSìˆ˜ì§‘_2",
            "type": "main",
            "index": 0
          },
          {
            "node": "RSSìˆ˜ì§‘_3",
            "type": "main",
            "index": 0
          },
          {
            "node": "NewsAPI_ìˆ˜ì§‘",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RSSìˆ˜ì§‘_1": {
      "main": [
        [
          {
            "node": "ì†ŒìŠ¤_íƒœê¹…",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RSSìˆ˜ì§‘_2": {
      "main": [
        [
          {
            "node": "ì†ŒìŠ¤_íƒœê¹…",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ì†ŒìŠ¤_íƒœê¹…": {
      "main": [
        [
          {
            "node": "ì¤‘ë³µ_ì œê±°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ì¤‘ë³µ_ì œê±°": {
      "main": [
        [
          {
            "node": "í‚¤ì›Œë“œ_í•„í„°ë§",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "í‚¤ì›Œë“œ_í•„í„°ë§": {
      "main": [
        [
          {
            "node": "ê°ì •_ë¶„ì„",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ê°ì •_ë¶„ì„": {
      "main": [
        [
          {
            "node": "ì¤‘ìš”ë„_íŒë‹¨",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ì¤‘ìš”ë„_íŒë‹¨": {
      "main": [
        [
          {
            "node": "Sheetsìš©_êµ¬ì¡°í™”",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Sheetsìš©_êµ¬ì¡°í™”": {
      "main": [
        [
          {
            "node": "Google_Sheets_ì €ì¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google_Sheets_ì €ì¥": {
      "main": [
        [
          {
            "node": "ìš”ì•½í†µê³„_ìƒì„±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ìš”ì•½í†µê³„_ìƒì„±": {
      "main": [
        [
          {
            "node": "AI_í”„ë¡¬í”„íŠ¸_ì¤€ë¹„",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI_í”„ë¡¬í”„íŠ¸_ì¤€ë¹„": {
      "main": [
        [
          {
            "node": "AIëª¨ë¸_ë¶„ê¸°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AIëª¨ë¸_ë¶„ê¸°": {
      "main": [
        [
          {
            "node": "Gemini_API",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "GPT4_API",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Claude_API",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Claude_API": {
      "main": [
        [
          {
            "node": "ì¸ì‚¬ì´íŠ¸_íŒŒì‹±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "GPT4_API": {
      "main": [
        [
          {
            "node": "ì¸ì‚¬ì´íŠ¸_íŒŒì‹±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ì¸ì‚¬ì´íŠ¸_íŒŒì‹±": {
      "main": [
        [
          {
            "node": "ë³´ê³ ì„œ_ìƒì„±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ë³´ê³ ì„œ_ìƒì„±": {
      "main": [
        [
          {
            "node": "ë°œì†¡ë°©ë²•_ì„ íƒ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ë°œì†¡ë°©ë²•_ì„ íƒ": {
      "main": [
        [
          {
            "node": "ì¹´ì¹´ì˜¤í†¡_ë°œì†¡",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Gmail_ë°œì†¡",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ì¹´ì¹´ì˜¤í†¡_ë°œì†¡",
            "type": "main",
            "index": 0
          },
          {
            "node": "Gmail_ë°œì†¡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ì¹´ì¹´ì˜¤í†¡_ë°œì†¡": {
      "main": [
        [
          {
            "node": "Webhook_ì‘ë‹µ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gmail_ë°œì†¡": {
      "main": [
        [
          {
            "node": "Webhook_ì‘ë‹µ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gemini_API": {
      "main": [
        [
          {
            "node": "ì¸ì‚¬ì´íŠ¸_íŒŒì‹±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RSSìˆ˜ì§‘_3": {
      "main": [
        [
          {
            "node": "ì†ŒìŠ¤_íƒœê¹…",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "NewsAPI_ìˆ˜ì§‘": {
      "main": [
        [
          {
            "node": "ì†ŒìŠ¤_íƒœê¹…",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "dac19db3-6566-438c-b2ee-3da305697766",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "4aae468442c323b9d7aeb70601530b18fe7dbbd836a0eb2623b1cb66bb4f0b2a"
  },
  "id": "QtdFoQfTB3HJKAZ5",
  "tags": []
}